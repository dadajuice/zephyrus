<?php namespace Zephyrus\Tests\Security\IntrusionDetection\Exploits;

use PHPUnit\Framework\TestCase;
use Zephyrus\Security\IntrusionDetection\IntrusionMonitor;
use Zephyrus\Security\IntrusionDetection\IntrusionReport;
use Zephyrus\Security\IntrusionDetection\IntrusionRuleLoader;

abstract class BaseExploitTest extends TestCase
{
    /**
     * Maintains in memory the entire IDS rules loaded from default file.
     *
     * @var array
     */
    private static array $rules;

    /**
     * Loads the entire IDS rules from default file for usage in all tests.
     */
    public static function setUpBeforeClass(): void
    {
        self::$rules = (new IntrusionRuleLoader())->loadFromFile();
    }

    protected function getReportForExploits(array $exploits): IntrusionReport
    {
        $monitor = new IntrusionMonitor(self::$rules);
        return $monitor->run($exploits);
    }
}
